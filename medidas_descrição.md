# medidas_descrição

|Tabela|Medida|Expressao|Formato|Descricao|Tipo|Pasta|
|---|---|---|---|---|---|---|
|Medidas|Clientes|DISTINCTCOUNT(olist_clientes_dataset[Cliente_ID])|#,0|Conta a quantidade de clientes|Número Inteiro|Clientes|
|Medidas|Ultima Data Pedido|MAX('olist_pedidos_dataset'[Data_compra]) |General Date|Conta a última data do pedido|Data/Hora|Temporais|
|Medidas|Ticket Médio| CALCULATE(     DIVIDE(         SUM(olist_produtos_pedidos_dataset[Valor_total]),         DISTINCTCOUNT(olist_produtos_pedidos_dataset[Pedido_ID])     ),     'olist_pedidos_dataset'[Status_Pedido] IN {         "approved",         "created",          "delivered",         "processing",         "shipped"     },     REMOVEFILTERS('olist_pedidos_dataset'[Status_Pedido]) )|"R$"#,0.00;-"R$"#,0.00;"R$"#,0.00|Calcula o ticket médio, filtrando apenas aqueles cujo status seja "aprovado, criado, processando, entregue"|Decimal|Ticket Médio|
|Medidas|Pedidos seller|DISTINCTCOUNT(olist_produtos_pedidos_dataset[Pedido_ID])|#,0|Contagem de pedidos do vendedor|Número Inteiro|Vendedores|
|Medidas|Média de frete|DIVIDE(SUM(olist_produtos_pedidos_dataset[Frete]),[Produtos],0)|"R$"#,0.00;-"R$"#,0.00;"R$"#,0.00|Calcula a média do frete dos pedidos|Decimal|Vendedores|
|Medidas|HTML Clientes por Status| // ObtÃ©m dados dos clientes por status VAR TabelaStatus =      ADDCOLUMNS(         VALUES(olist_pedidos_dataset[status_pedido]),         "@Clientes",              CALCULATE(                 DISTINCTCOUNT(olist_pedidos_dataset[Cliente_ID])             ),         "@StatusNome",             SWITCH(                 [status_pedido],                 "delivered",   "Entregue",                 "shipped",     "Enviado",                 "canceled",    "Cancelado",                 "unavailable", "IndisponÃ­vel",                 "invoiced",    "Faturado",                 "processing",  "Processando",                 "created",     "Criado",                 "approved",    "Aprovado",                 [status_pedido]             ),         // ... (cores e Ã­cones permanecem os mesmos)         "@Cor",             SWITCH(                 [status_pedido],                 "delivered",   "#10B981",  // Verde                 "shipped",     "#3B82F6",  // Azul                 "approved",    "#8B5CF6",  // Roxo                 "invoiced",    "#7C3AED",  // Roxo escuro                 "processing",  "#06B6D4",  // Ciano                 "created",     "#6B7280",  // Cinza                 "unavailable", "#F59E0B",  // Ã‚mbar                 "canceled",    "#EF4444",  // Vermelho                 "#9CA3AF"   // Cinza             ),         "@Icone",             SWITCH(                 [status_pedido],                 "delivered",   "âœ“",                 "shipped",     "ðŸšš",                 "approved",    "âœ…",                 "invoiced",    "ðŸ’°",                 "processing",  "â³",                 "created",     "ðŸ“",                 "unavailable", "âš ",                 "canceled",    "âŒ",                 "â—"             )     )  VAR TabelaOrdenada =      TOPN(         COUNTROWS(TabelaStatus),         // *** ALTERAÃ‡ÃƒO AQUI: Filtra para clientes > 50 e clientes > 0 ***         FILTER(TabelaStatus, [@Clientes] > 50 && [@Clientes] > 0),          [@Clientes], ASC     )  VAR TotalClientes =      SUMX(TabelaOrdenada, [@Clientes])  VAR MaxClientes =      MAXX(TabelaOrdenada, [@Clientes])  // Cria o HTML do grÃ¡fico VAR Linhas =      CONCATENATEX(         TabelaOrdenada,         VAR StatusNome = [@StatusNome]         VAR Clientes = [@Clientes]         VAR Cor = [@Cor]         VAR Icone = [@Icone]         VAR Percentual = DIVIDE(Clientes, TotalClientes, 0)         VAR LarguraBarra =              FORMAT(                 DIVIDE(Clientes, MaxClientes, 0) * 100,                  "0"             )         VAR ClientesFmt = FORMAT(Clientes, "#,##0")         VAR PercentualFmt = FORMAT(Percentual, "0.0%")                  RETURN         "         <div style='margin-bottom:14px;'>             <div style='display:flex; justify-content:space-between; align-items:center; margin-bottom:5px;'>                 <div style='display:flex; align-items:center; gap:8px;'>                     <span style='font-size:15px; color:" & Cor & "; font-weight:600;'>" & Icone & "</span>                     <span style='font-size:15px; font-weight:600; color:#1F2937;'>" & StatusNome & "</span>                 </div>                 <div style='display:flex; gap:10px; align-items:center;'>                     <span style='font-size:14px; font-weight:700; color:#374151;'>" & ClientesFmt & "</span>                     <span style='font-size:13px; color:#6B7280; background:#F3F4F6; padding:3px 7px; border-radius:12px;'>" & PercentualFmt & "</span>                 </div>             </div>                          <div style='height:10px; background:#E5E7EB; border-radius:5px; overflow:hidden; position:relative;'>                 <div style='height:100%; width:" & LarguraBarra & "%;                               background:" & Cor & ";                               border-radius:5px;                              transition:width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);'>                 </div>             </div>         </div>         "     )  // EstatÃ­sticas resumidas (ajustadas para refletir o TotalClientes filtrado se necessÃ¡rio) VAR Stats =      VAR Entregues =          SUMX(             FILTER(TabelaStatus, [status_pedido] = "delivered"),              [@Clientes]         )     VAR Cancelados =          SUMX(             FILTER(TabelaStatus, [status_pedido] = "canceled"),              [@Clientes]         )     VAR TaxaEntregue =          IF(TotalClientes > 0, DIVIDE(Entregues, TotalClientes, 0), 0)     RETURN     "     <div style='display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:16px;'>         <div style='background:#F0F9FF; padding:10px; border-radius:8px;'>             <div style='font-size:13px; color:#0369A1; font-weight:600;'>Clientes Totais (Filtrados)</div>             <div style='font-size:19px; font-weight:700; color:#0C4A6E;'>" & FORMAT(TotalClientes, "#,##0") & "</div>         </div>         <div style='background:#F0FDF4; padding:10px; border-radius:8px;'>             <div style='font-size:13px; color:#15803D; font-weight:600;'>Taxa de Entrega</div>             <div style='font-size:19px; font-weight:700; color:#14532D;'>" & FORMAT(TaxaEntregue, "0.0%") & "</div>         </div>     </div>     "  RETURN "<div style='padding:15px; font-family:-apple-system, BlinkMacSystemFont, sans-serif;'>     <div style='display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;'>         <div style='font-size:17px; font-weight:700; color:#111827;'>Clientes por Status de Pedido</div>         <div style='font-size:13px; color:#6B7280; background:#F9FAFB; padding:5px 10px; border-radius:14px;'>             " & COUNTROWS(TabelaOrdenada) & " status visÃ­veis         </div>     </div>          " & Stats & "          " & Linhas & " </div>"| |Medida que calcula a contagem de clientes por status de pedido e constrói o código HTML (incluindo CSS) para exibir um gráfico de barras estilizado (com ícones, cores e percentuais)|Texto|HTML|
|Medidas|Medida_HTML_Palavras| VAR Palavras_Classificadas =     -- 1. Defina a lÃ³gica de classificaÃ§Ã£o (ajuste esta parte com sua tabela de mapeamento)     ADDCOLUMNS(         TOPN(             12, -- Pega as Top 15 Palavras             ALL('Top 23 palavras'),             'Top 23 palavras'[FrequÃªncia], DESC         ),         "Sentimento",         SWITCH(             TRUE(),             'Top 23 palavras'[Palavra] IN {"Ã“timo", "RÃ¡pido", "Qualidade", "Excelente", "Perfeito", "Recomendo","bom","bem"}, "Positivo",             'Top 23 palavras'[Palavra] IN {"Demora", "Defeito", "Problema"}, "Negativo",             'Top 23 palavras'[Palavra] IN {"produto","entregue","chegou","recebi","comprei","ainda","veio","loja"}, "Neutro" -- Default         )     )  VAR HTML_Output =     CONCATENATEX(         Palavras_Classificadas,         -- 2. ConstrÃ³i a tag HTML/CSS para cada palavra         VAR Frequencia_Formatada = FORMAT('Top 23 palavras'[FrequÃªncia], "#,##0")         VAR Cor_CSS =             SWITCH(                 [Sentimento],                 "Positivo", "border: 1px solid #00AA55; color: #00AA55; background-color: #E6F5EF;", -- Verde                 "Negativo", "border: 1px solid #FF5555; color: #FF5555; background-color: #FFEEED;", -- Vermelho                 "border: 1px solid #AAAAAA; color: #555555; background-color: #F0F0F0;"  -- Cinza/Neutro             )         RETURN             "<span style='display: inline-block; padding: 5px 10px; margin: 4px; border-radius: 20px; font-size: 16px; font-weight: 500; " & Cor_CSS & "'>" &             'Top 23 palavras'[Palavra] & " (" & Frequencia_Formatada & ") " &             "</span>",         "" -- Sem separador entre as tags     )  RETURN     HTML_Output| |Seleciona as principais palavras de uma análise de texto (Top 23 palavras), classifica-as como Positivo, Negativo ou Neutro e gera um código HTML/CSS para exibir estas palavras em formato de tag (nuvem de tags), coloridas pelo sentimento.|Texto|AnÃ¡lise Sentimentos|
|Medidas|Sentimento Negativo| COUNTROWS(     FILTER(         'Base_com_Sentimento',         'Base_com_Sentimento'[Sentimento] = "NEGATIVO"     ) )|#,0|Contam o número de comentários classificados como negativos na categoria de sentimento na tabela Base_com_Sentimento.|Número Inteiro|AnÃ¡lise Sentimentos|
|Medidas|Sentimento Neutro| COUNTROWS(     FILTER(         'Base_com_Sentimento',         'Base_com_Sentimento'[Sentimento] = "NEUTRO"     ) )|0|Contam o número de comentários classificados como neutros na categoria de sentimento na tabela Base_com_Sentimento.|Número Inteiro|AnÃ¡lise Sentimentos|
|Medidas|Sentimento Positivo| COUNTROWS(     FILTER(         'Base_com_Sentimento',         'Base_com_Sentimento'[Sentimento] = "POSITIVO"     ) )|#,0|Contam o número de comentários classificados como positivos na categoria de sentimento na tabela Base_com_Sentimento.|Número Inteiro|AnÃ¡lise Sentimentos|
|Medidas|Sentimentos| CALCULATE(     COUNTROWS('Base_com_Sentimento'),     NOT(ISBLANK('Base_com_Sentimento'[Sentimento])) )|0|Conta o total de comentários que foram classificados com algum sentimento (não nulo).|Número Inteiro| |
|Medidas|% Clientes do Total| DIVIDE(     [Clientes],     CALCULATE(         [Clientes],         ALL(olist_pedidos_dataset[status_pedido])     ),     0 )| |Conta % de clientes do filtro atual em relação à todos os clientes de todos os status de pedidos|Decimal|Clientes|
|Medidas|% Receita Acumulado| DIVIDE(     [Receita Acumulada],     CALCULATE([Receita Total], ALLSELECTED('olist_produtos_dataset'[Categoria])) ) |0.00%;-0.00%;0.00%|Calcula o % de receita acumulada|Decimal|Receita|
|Medidas|Cliente YoY %| DIVIDE(     [Clientes Ano Atual] - [Clientes Ano Anterior],     [Clientes Ano Anterior] ) | |Diferença percentual de clientes do ano atual em relação ao ano anterior|Decimal|Clientes|
|Medidas|Clientes Ano Anterior| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario),         USERELATIONSHIP(dCalendario[Data], olist_pedidos_dataset[Data_compra])     ) VAR AnoAnterior = AnoMax - 1 RETURN CALCULATE(     [Clientes],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoAnterior     ),     USERELATIONSHIP(dCalendario[Data], olist_pedidos_dataset[Data_compra]) ) |0|Conta o número de clientes únicos no ano imediatamente anterior ao Ano Atual.|Número Inteiro|Clientes|
|Medidas|Clientes Ano Atual| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario),         USERELATIONSHIP(dCalendario[Data], olist_pedidos_dataset[Data_compra])     ) RETURN CALCULATE(     [Clientes],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoMax     ),     USERELATIONSHIP(dCalendario[Data], olist_pedidos_dataset[Data_compra]) )|0|Conta o número de clientes únicos no ano mais recente disponível na base de dados.|Número Inteiro|Clientes|
|Medidas|Clientes DiferenÃ§a YoY|     [Clientes Ano Atual] - [Clientes Ano Anterior]    |0|Diferença absoluta: [Clientes Ano Atual] - [Clientes Ano Anterior].|Número Inteiro|Clientes|
|Medidas|Clientes Novos desde Q3 2018| VAR ClientesDesde_Q3_2018 =      CALCULATETABLE(         VALUES(olist_pedidos_dataset[Cliente_ID]),         USERELATIONSHIP(dCalendario[Data], olist_pedidos_dataset[Data_compra]),         dCalendario[Ano] = 2018         // dCalendario[Trimestre] IN { "T3", "T4"}     )      VAR ClientesAntes_2018 =      CALCULATETABLE(         VALUES(olist_pedidos_dataset[Cliente_ID]),         USERELATIONSHIP(dCalendario[Data], olist_pedidos_dataset[Data_compra]),         dCalendario[Ano] < 2018     )  // Clientes que compraram em 2018 mas nÃ£o antes = Novos em 2018 VAR ClientesNovos_2018 =      EXCEPT(ClientesDesde_Q3_2018, ClientesAntes_2018)  RETURN COUNTROWS(ClientesNovos_2018)|#,0|Calcula o número de clientes novos desde o terceiro trimestre de 2018|Número Inteiro|Clientes|
|Medidas|KPI Clientes YoY (RÃ³tulo)| VAR CrescimentoPerc = [Cliente YoY %] VAR DifValor = [Clientes DiferenÃ§a YoY]  VAR Seta =     IF(         CrescimentoPerc >= 0,         "â–²",   -- seta bonita pra cima         "â–¼"    -- seta bonita pra baixo     )  VAR PercFormatado =     FORMAT(CrescimentoPerc, "0.0%")  VAR ValorFormatado =     FORMAT(DifValor, "#,0")  RETURN Seta & " " & PercFormatado & " "| " & ValorFormatado | |Calcula a variação percentual de clientes (YoY) e a diferença absoluta entre o ano atual e o ano anterior. O resultado é exibido como um rótulo de KPI formatado que inclui uma seta (▲ para crescimento, ▼ para declínio) e os dois valores separados por um pipe ("|). Utilizada em cartões de desempenho (KPI cards) no painel principal."|Texto|CartÃµes|
|Medidas|KPI Produtos YoY (RÃ³tulo)| VAR CrescimentoPerc = [Produtos YoY %] VAR DifValor = [Produtos DiferenÃ§a YoY]  VAR Seta =     IF(         CrescimentoPerc >= 0,         "â–²",         "â–¼"     )  VAR PercFormatado =     FORMAT(CrescimentoPerc, "0.0%")  VAR ValorFormatado =     FORMAT(DifValor, "#,0", "pt-BR")  RETURN Seta & " " & PercFormatado & " "| " & ValorFormatado  | |Calcula a variação percentual de produtos (YoY) e a diferença absoluta entre o ano atual e o ano anterior. O resultado é exibido como um rótulo de KPI formatado que inclui uma seta (▲ para crescimento, ▼ para declínio) e os dois valores separados por um pipe ("|). Utilizada em cartões de desempenho (KPI cards) no painel principal."|Texto|CartÃµes|
|Medidas|KPI Receita YoY (RÃ³tulo)| VAR CrescimentoPerc = [Receita YoY %] VAR DifValor = [Receita DiferenÃ§a YoY]  VAR Seta =     IF(         CrescimentoPerc >= 0,         "â–²",   -- seta bonita pra cima         "â–¼"    -- seta bonita pra baixo     )  VAR PercFormatado =     FORMAT(CrescimentoPerc, "0.0%")  VAR ValorFormatado =     FORMAT(DifValor, "#,0")  RETURN Seta & " " & PercFormatado & " "| " & ValorFormatado | |Calcula a variação percentual de receita (YoY) e a diferença absoluta entre o ano atual e o ano anterior. O resultado é exibido como um rótulo de KPI formatado que inclui uma seta (▲ para crescimento, ▼ para declínio) e os dois valores separados por um pipe ("|). Utilizada em cartões de desempenho (KPI cards) no painel principal."|Texto|CartÃµes|
|Medidas|KPI Ticket Médio YoY (RÃ³tulo)| VAR CrescimentoPerc = [Ticket Médio YoY %]  VAR DifValor = [TKM DiferenÃ§a YoY]  VAR Seta =     IF(         CrescimentoPerc >= 0,         "â–²",   -- seta bonita pra cima         "â–¼"    -- seta bonita pra baixo     )  VAR PercFormatado =     FORMAT(CrescimentoPerc, "0.0%")  VAR ValorFormatado =     FORMAT(DifValor, "#,0")  RETURN Seta & " " & PercFormatado & " "| " & ValorFormatado | |Calcula a variação percentual de ticket médio (YoY) e a diferença absoluta entre o ano atual e o ano anterior. O resultado é exibido como um rótulo de KPI formatado que inclui uma seta (▲ para crescimento, ▼ para declínio) e os dois valores separados por um pipe ("|). Utilizada em cartões de desempenho (KPI cards) no painel principal."|Texto|CartÃµes|
|Medidas|Produtos Ano anterior| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario)     ) VAR AnoAnterior = AnoMax - 1 RETURN CALCULATE(     [Produtos],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoAnterior     ) ) |0|Calcula o número de produtos do ano anterior ao presente na base.|Número Inteiro|Produtos|
|Medidas|Produtos Ano Atual| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario)     ) RETURN CALCULATE(     [Produtos],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoMax     ) ) |0|Calcula o número de produtos do ano mais recente presente na base|Número Inteiro|Produtos|
|Medidas|Produtos DiferenÃ§a YoY| [Produtos Ano Atual] - [Produtos Ano anterior] |0|Calcula a diferença absoluta entre o número de produtos do ano atual e do ano anterior|Número Inteiro|Produtos|
|Medidas|Produtos YoY %| DIVIDE(     [Produtos Ano Atual] - [Produtos Ano Anterior],     [Produtos Ano Anterior] ) |0.00%;-0.00%;0.00%|Calcula a diferença percentual entre o número de produtos do ano atual e do ano anterior|Decimal|Produtos|
|Medidas|Cor Pareto| VAR PercAcum = [% Receita Acumulado]   -- sua medida de Pareto RETURN IF(     PercAcum <= 0.80,     "#4CAF50",      -- verde (top contribuidores)     "#E53935"       -- vermelho (demais) ) | |Medida que retorna em formatação condicional cor verde para os 20% que mais contribuem com a receita acumulada, e vermelho para os demais.|Texto|Produtos|
|Medidas|Receita Acumulada| VAR CategoriaAtual = SELECTEDVALUE('olist_produtos_dataset'[Categoria]) RETURN CALCULATE(     [Receita Total],     FILTER(         ALLSELECTED('olist_produtos_dataset'[Categoria]),         [Receita Total] >=             CALCULATE([Receita Total], 'olist_produtos_dataset'[Categoria] = CategoriaAtual)     ) ) |0|Medida que retorna toda a receita acumulada durante o período|Número Inteiro|Receita|
|Medidas|Receita Ano Anterior| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario)     ) VAR AnoAnterior = AnoMax - 1 RETURN CALCULATE(     [Receita total],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoAnterior     ) ) | |Medida que retorna a receita do ano anterior ao ano presente na base.|Número Inteiro|Receita|
|Medidas|Receita Ano Atual| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario)     ) RETURN CALCULATE(     [Receita total],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoMax     ) ) |0|Medida que retorna a receita do ano mais recente da base.|Número Inteiro|Receita|
|Medidas|Receita DiferenÃ§a YoY| [Receita Ano Atual] - [Receita Ano Anterior] |0|Calcula a diferença absoluta entre a quantidade de receita do ano mais recente da base e o ano anterior a esse.|Número Inteiro|Receita|
|Medidas|Receita total|SUM(olist_produtos_pedidos_dataset[Valor_total])|"R$"#,0;-"R$"#,0;"R$"#,0|Calcula a receita total, somando o valor total dos pedidos vendidos|Número Inteiro|Receita|
|Medidas|Receita YoY %| DIVIDE(     [Receita Ano Atual] - [Receita Ano Anterior],     [Receita Ano Anterior] ) |0.0%;-0.0%;0.0%|Calcula a diferença percentual entre a quantidade de receita do ano mais recente da base e o ano anterior a esse.|Decimal|Receita|
|Medidas|Texto explicativo|"Variação em relação ao ano anterior"| |Retorna um texto: Variação em relação ao ano anterior. Utilizado nos rótulos de referência dos cartões da tela home.|Texto|CartÃµes|
|Medidas|Ticket Médio Ano Anterior| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario)     ) VAR AnoAnterior = AnoMax - 1 RETURN CALCULATE(     [Ticket Médio],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoAnterior     ) ) | |Medida que retorna o ticket médio do ano anterior ao ano presente na base.|Decimal|Ticket Médio|
|Medidas|Ticket Médio Ano Atual| VAR AnoMax =     CALCULATE(         MAX(dCalendario[Ano]),         ALL(dCalendario)     ) RETURN CALCULATE(     [Ticket Médio],     FILTER(         ALL(dCalendario),         dCalendario[Ano] = AnoMax     ) ) | |Medida que retorna o ticket médio do ano mais recente da base.|Decimal|Ticket Médio|
|Medidas|Ticket Médio YoY %| DIVIDE(     [Ticket Médio Ano Atual] - [Ticket Médio Ano Anterior],     [Ticket Médio Ano Anterior] ) | |Calcula a diferença percentual entre a o valor do ticket médio do ano mais recente da base e o ano anterior a esse.|Decimal|Ticket Médio|
|Medidas|TKM DiferenÃ§a YoY|     [Ticket Médio Ano Atual] - [Ticket Médio Ano Anterior]    | |Calcula a diferença absoluta entre a o valor do ticket médio do ano mais recente da base e o ano anterior a esse.|Decimal|Ticket Médio|
|Medidas|% Detratores| DIVIDE( [Qtd Detratores], [Total Avaliações] ) |0.0%;-0.0%;0.0%|Conta o valor percentual de detratores em relação ao total de avaliações|Decimal|Avaliações|
|Medidas|% Promotores| DIVIDE( [Qtd Promotores], [Total Avaliações] ) |0.00%;-0.00%;0.00%|Conta o valor percentual de promotores em relação ao total de avaliações|Decimal|Avaliações|
|Medidas|Nota mÃ©dia|AVERAGE('olist_Avaliações_dataset'[Nota])| |Calcula a média de notas das avaliações|Decimal|Avaliações|
|Medidas|NPS| ([% Promotores] - [% Detratores]) * 100 | |Calcula o NPS, que é a diferença entre o percentual de promotores e detratores, multiplicado por 100|Decimal|Avaliações|
|Medidas|ComentÃ¡rios|COUNTROWS(Base_com_Sentimento)  |#,0|Calcula o total de clientes que deixaram comentários|Número Inteiro|Avaliações|
|Medidas|Qtd Detratores| CALCULATE(     COUNTROWS('olist_Avaliações_dataset'),     'olist_Avaliações_dataset'[Categoria_NPS] = "Detrator" ) |0|Contam o número de avaliações cujo NPS foi detrator (nota 1 ou 2)|Número Inteiro|Avaliações|
|Medidas|Qtd Neutros| CALCULATE(     COUNTROWS('olist_Avaliações_dataset'),     'olist_Avaliações_dataset'[Categoria_NPS] = "Neutro" ) |0|Contam o número de avaliações cujo NPS foi neutro  (nota 3)|Número Inteiro|Avaliações|
|Medidas|Qtd Promotores| CALCULATE(     COUNTROWS('olist_Avaliações_dataset'),     'olist_Avaliações_dataset'[Categoria_NPS] = "Promotor" ) |#,0|Contam o número de avaliações cujo NPS foi positivo  (nota 4 ou 5)|Número Inteiro|Avaliações|
|Medidas|Data Referência| CALCULATE(     MAX(olist_pedidos_dataset[Data_compra]),     ALL(olist_pedidos_dataset) ) |General Date|Calcula a data mais recente de compra.|Data/Hora|Pedidos|
|Medidas|Legenda peso otimizada|  VAR Legendapeso = "<style>     /* 1. ESTILOS GERAIS: HORIZONTAL E DISCRETO */     .legend-container {         display: flex;          flex-wrap: wrap;          justify-content: flex-start;         align-items: center;                  font-family: 'Segoe UI', Arial, sans-serif;         font-size: 13px; /* Aumentado para 13px */         color: #4A5568;         padding: 4px 8px;         background: transparent;         border: none;         box-shadow: none;         max-width: 685px;          max-height: none;         overflow: hidden;         gap: 20px; /* EspaÃ§amento maior entre itens, jÃ¡ que o texto Ã© menor */         line-height: 1.6;     }      /* 2. REMOVER ESTILOS DO TÃTULO (nÃ£o serÃ¡ usado) */     .legend-title {         display: none;      }      /* 3. ESTILO DE CADA ITEM: SIMPLES E HORIZONTAL */     .legend-item {         display: flex;         align-items: center;         white-space: nowrap;          margin: 0;         padding: 0;          background: transparent;         box-shadow: none;         border: none;         transition: none;     }      /* 4. CAIXA DE COR: AJUSTADA */     .color-box {         width: 12px; /* Ligeiramente maior */         height: 12px;         min-width: 12px;         margin-right: 6px;          border-radius: 3px;         box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);         border: none;     }      /* 5. TEXTO E PESO: ALINHADOS */     .legend-text {         /* Oculto */         display: none;     }      .legend-weight {         font-weight: 600;         color: #4A5568; /* Cor principal para o texto */         margin-left: 0;          font-size: 13px; /* NOVO: Fonte aumentada para 13px */         padding: 0;         background: transparent;         border: none;     }      /* Cores das Faixas: MANTIDAS */     .c-superleve { background: linear-gradient(135deg, #B0BEC5 0%, #90A4AE 100%); }     .c-pequeno { background: linear-gradient(135deg, #90CAF9 0%, #64B5F6 100%); }     .c-medio { background: linear-gradient(135deg, #64B5F6 0%, #42A5F5 100%); }     .c-grande { background: linear-gradient(135deg, #42A5F5 0%, #2196F3 100%); }     .c-extragrande { background: linear-gradient(135deg, #1E88E5 0%, #1976D2 100%); }     .c-pesado { background: linear-gradient(135deg, #4CAF50 0%, #43A047 100%); }     .c-cargaexpressa { background: linear-gradient(135deg, #1A9850 0%, #137736 100%); }     .c-cargamaxima { background: linear-gradient(135deg, #D73027 0%, #C62828 100%); }  </style>  <div class='legend-container'>     <div class='legend-item'>         <span class='color-box c-superleve'></span>         <span class='legend-weight'>0â€“0.2 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-pequeno'></span>         <span class='legend-weight'>0.2â€“0.5 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-medio'></span>         <span class='legend-weight'>0.5â€“1 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-grande'></span>         <span class='legend-weight'>1â€“1.9 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-extragrande'></span>         <span class='legend-weight'>1.9â€“5 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-pesado'></span>         <span class='legend-weight'>5â€“10 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-cargaexpressa'></span>         <span class='legend-weight'>10â€“35 kg</span>     </div>     <div class='legend-item'>         <span class='color-box c-cargamaxima'></span>         <span class='legend-weight'>35 kg+</span>     </div> </div>" RETURN Legendapeso| |Medida HTML que retorna uma legenda para cada faixa de peso, explicando o valor em kgs e a cor associada.|Texto|Produtos|
|Medidas|Total Avaliações| COUNTROWS('olist_Avaliações_dataset') |#,0|Calcula o número de avaliações|Número Inteiro|Avaliações|
|Medidas|Tempo MÃ©dio de Resposta (dias)| AVERAGEX(     FILTER(         'olist_Avaliações_dataset',         NOT ISBLANK('olist_Avaliações_dataset'[data_resposta_avaliacao])     ),     DATEDIFF(         'olist_Avaliações_dataset'[Data_criaÃ§Ã£o],         'olist_Avaliações_dataset'[data_resposta_avaliacao],         DAY     ) ) | |Calcula uma média do tempo de resposta em dias, através da diferença entre a data de criação da avaliação e a data de resposta da empresa|Decimal|Avaliações|
|Medidas|HTML Pagamentos Premium| VAR TotalPedidos = [Total Pedidos]  /*      1) Criamos uma "tabela enriquecida"        contendo: forma_pgto, pedidos, porcentagem etc. */ VAR TabelaClassificada =     ADDCOLUMNS(         FILTER(             VALUES('olist_pagamentos_dataset'[forma_pgto]),             'olist_pagamentos_dataset'[forma_pgto] <> "not_defined"         ),         "@Qtde", [Pedidos Pgto],         "@Perc", DIVIDE([Pedidos Pgto], TotalPedidos, 0)     )  /*      2) Ordenamos pela nova coluna virtual @Qtde */ VAR TabelaOrdenada =     TOPN(         COUNTROWS(TabelaClassificada),         TabelaClassificada,         [@Qtde], DESC     )  /*     3) Montamos o HTML em LOOP */ VAR Linhas =     CONCATENATEX(         TabelaOrdenada,                  VAR Pgto = 'olist_pagamentos_dataset'[forma_pgto]         VAR Qtde = [@Qtde]         VAR Perc = [@Perc]          VAR PgtoNome =             SWITCH(                 Pgto,                 "credit_card", "CartÃ£o de CrÃ©dito",                 "debit_card",  "CartÃ£o de DÃ©bito",                 "boleto",      "Boleto",                 "voucher",     "Voucher",                 Pgto             )          /* ICONES SVG PREMIUM */         VAR IconeSVG =             SWITCH(                 Pgto,                  "credit_card",                 "<svg width='22' height='22' viewBox='0 0 24 24' fill='none'>                     <rect x='2' y='5' width='20' height='14' rx='3' fill='#4F46E5'/>                     <rect x='4' y='8' width='16' height='3' fill='white'/>                     <rect x='4' y='12' width='5' height='4' rx='1' fill='white'/>                 </svg>",                  "debit_card",                 "<svg width='22' height='22' viewBox='0 0 24 24' fill='none'>                     <rect x='2' y='5' width='20' height='14' rx='3' fill='#059669'/>                     <circle cx='8' cy='12' r='2' fill='white'/>                     <rect x='12' y='11' width='6' height='2' rx='1' fill='white'/>                 </svg>",                  "boleto",                 "<svg width='22' height='22' viewBox='0 0 24 24' fill='none'>                     <rect x='3' y='4' width='18' height='16' rx='2' fill='#EA580C'/>                     <path d='M6 6V18M9 6V18M12 6V18M15 6V18M18 6V18' stroke='white' stroke-width='2'/>                 </svg>",                  "voucher",                 "<svg width='22' height='22' viewBox='0 0 24 24' fill='none'>                     <rect x='4' y='3' width='16' height='18' rx='3' fill='#7C3AED'/>                     <circle cx='12' cy='8' r='2' fill='white'/>                     <path d='M8 12H16M8 15H16' stroke='white' stroke-width='2'/>                 </svg>",                  /* fallback */                 "<svg width='22' height='22' viewBox='0 0 24 24' fill='#6B7280'>                     <circle cx='12' cy='12' r='10'/>                 </svg>"             )          /* Cores */         VAR Cor =             SWITCH(                 Pgto,                 "credit_card", "#4F46E5",                 "debit_card",  "#059669",                 "boleto",      "#EA580C",                 "voucher",     "#7C3AED",                 "#6B7280"             )          VAR CorClara =             SWITCH(                 Pgto,                 "credit_card", "#EEF2FF",                 "debit_card",  "#D1FAE5",                 "boleto",      "#FFEDD5",                 "voucher",     "#F3E8FF",                 "#E5E7EB"             )          VAR Largura = FORMAT(Perc * 100, "0")         VAR PercFmt = FORMAT(Perc, "0.0%")         VAR QtdeFmt = FORMAT(Qtde, "#,0")          RETURN         "         <div style='padding:10px; background:" & CorClara & ";                      border-radius:10px; margin-bottom:10px;                     transition:all .25s; box-shadow:0 1px 4px rgba(0,0,0,0.08);'>              <div style='display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;'>                 <div style='display:flex; gap:8px; align-items:center;'>                     <div>" & IconeSVG & "</div>                     <span style='font-size:13px; font-weight:600; color:#1F2937;'>" & PgtoNome & "</span>                 </div>                  <div style='display:flex; gap:6px; align-items:center;'>                     <span style='background:white; padding:2px 8px;                                   border-radius:12px; border:1px solid #eee;                                  font-family:monospace; font-weight:700;'>                         " & QtdeFmt & "                     </span>                      <span style='background:white; padding:2px 8px;                                   border-radius:12px; border:1px solid #eee;                                  font-family:monospace; font-weight:600; color:" & Cor & ";'>                         " & PercFmt & "                     </span>                 </div>             </div>              <div style='background:white; height:6px; border-radius:4px; overflow:hidden;'>                 <div style='height:100%; width:" & Largura & "%;                              background:" & Cor & ";                             transition:width .6s cubic-bezier(.34,1.56,.64,1);'>                 </div>             </div>         </div>         "     )  RETURN "<div style='padding:4px; font-family:-apple-system, BlinkMacSystemFont, sans-serif;'>     <div style='font-size:14px; font-weight:700; margin-bottom:12px; color:#374151;'>     </div>      " & Linhas & "      <div style='text-align:center; margin-top:12px; font-size:10px; color:#9CA3AF;'>         Atualizado em " & FORMAT(NOW(), "dd/MM") & "     </div> </div>" | |O principal objetivo desta medida é fornecer uma visão imediata  sobre a preferência de pagamento dos clientes, mostrando a quantidade e o percentual de pedidos para as principais formas de pagamento, como Cartão de Crédito, Boleto, Débito e Voucher.|Texto|HTML|
|Medidas|HTML Pedidos Recentes2| VAR Base =     ADDCOLUMNS(         'olist_pedidos_dataset',         "@Cliente", RELATED('olist_clientes_dataset'[Cliente_ID]),         "@Estado", RELATED('olist_clientes_dataset'[Estado]),         "@Cidade", RELATED('olist_clientes_dataset'[Cidade]),         "@CEP", RELATED('olist_clientes_dataset'[cep_cliente_inicial]),         "@Valor", CALCULATE(SUM('olist_produtos_pedidos_dataset'[Valor_total])),         "@Categoria",              VAR TabelaCategorias =                 CALCULATETABLE(                     VALUES('olist_produtos_dataset'[Categoria])                 )             VAR ContagemCategorias =                 ADDCOLUMNS(                     TabelaCategorias,                     "@Contagem", CALCULATE(COUNTROWS('olist_produtos_pedidos_dataset'))                 )             VAR CategoriaMaisComum =                 TOPN(1, ContagemCategorias, [@Contagem], DESC)             RETURN                 MAXX(CategoriaMaisComum, 'olist_produtos_dataset'[Categoria]),         "@Status", 'olist_pedidos_dataset'[Status_br]     )  // AJUSTE: Reduzido de 60 para 20 pedidos para melhor visualizaÃ§Ã£o VAR TopPedidos =     TOPN(         20,         Base,         'olist_pedidos_dataset'[Pedido_ID], DESC     )  VAR TabelaFormatada =     ADDCOLUMNS(         TopPedidos,         "@HtmlLinha",             VAR PedidoID = 'olist_pedidos_dataset'[Pedido_ID]             VAR Cliente = [@Cliente]             VAR Categoria = [@Categoria]             VAR ValorNum = [@Valor]             VAR Valor = FORMAT(ValorNum, "R$ #,##0.00")             VAR StatusBR = [@Status]                          VAR CorStatus =                 SWITCH(                     StatusBR,                     "Entregue", "#10B981",                     "Enviado", "#3B82F6",                      "Pendente", "#F59E0B",                     "Cancelado", "#EF4444",                     "#6B7280"                 )                          VAR CorBG =                 SWITCH(                     StatusBR,                     "Entregue", "#D1FAE5",                     "Enviado", "#DBEAFE",                     "Pendente", "#FEF3C7",                     "Cancelado", "#FEE2E2",                     "#E5E7EB"                 )                          // Ãcone baseado no status             VAR Icone =                 SWITCH(                     StatusBR,                     "Entregue", "âœ“",                     "Enviado", "â†’",                     "Pendente", "âŒ›",                     "Cancelado", "âœ•",                     "â€¢"                 )                          RETURN                 "<tr style='border-bottom:1px solid #f0f0f0; transition: background-color 0.2s;'>                     <td style='padding:12px 8px; font-weight:600; color:#1F2937; font-size:14px; border-left:3px solid " & CorStatus & ";'>                         <div style='font-size:11px; color:#6B7280; margin-bottom:2px;'>PEDIDO</div>                         " & LEFT(PedidoID, 8) & "                     </td>                     <td style='padding:12px 8px; color:#374151; font-size:14px;'>                         <div style='font-size:11px; color:#6B7280; margin-bottom:2px;'>CLIENTE</div>                         " & Cliente & "                     </td>                     <td style='padding:12px 8px; color:#4B5563; font-size:14px;'>                         <div style='font-size:11px; color:#6B7280; margin-bottom:2px;'>CATEGORIA</div>                         " & Categoria & "                     </td>                     <td style='padding:12px 8px; font-weight:700; color:#111827; font-size:14px;'>                         <div style='font-size:11px; color:#6B7280; margin-bottom:2px;'>VALOR</div>                         " & Valor & "                     </td>                     <td style='padding:12px 8px; font-size:14px;'>                         <div style='font-size:11px; color:#6B7280; margin-bottom:2px;'>STATUS</div>                         <span style='background:" & CorBG & "; padding:4px 10px; border-radius:12px; font-size:12px; color:" & CorStatus & "; font-weight:600; display:inline-flex; align-items:center; gap:4px;'>                             " & Icone & " " & StatusBR & "                         </span>                     </td>                     <td style='padding:12px 8px; color:#D1D5DB; font-size:20px; vertical-align:middle;'>                         <div style='cursor:pointer; width:24px; height:24px; display:flex; align-items:center; justify-content:center; border-radius:4px; transition:background-color 0.2s;'                               onmouseover='this.style.backgroundColor=""#F3F4F6""'                               onmouseout='this.style.backgroundColor=""transparent""'>                             â‹¯                         </div>                     </td>                 </tr>"     )  VAR TabelaLinhas =     CONCATENATEX(         TabelaFormatada,         [@HtmlLinha],         "",         'olist_pedidos_dataset'[Pedido_ID], DESC     )  RETURN     "<div style='font-family: -apple-system, BlinkMacSystemFont, ""Segoe UI"", Roboto, sans-serif;                 background:white; border-radius:16px; padding:20px 24px;                 box-shadow:0 4px 16px rgba(0,0,0,0.08); border:1px solid #E5E7EB;'>          <!-- CabeÃ§alho com Ã­cone -->         <div style='display:flex; align-items:center; justify-content:space-between; margin-bottom:20px;'>             <div>                 <div style='display:flex; align-items:center; gap:10px; margin-bottom:4px;'>                     <div style='width:4px; height:20px; background:#3B82F6; border-radius:2px;'></div>                     <!-- AJUSTE: TÃ­tulo alterado para foco em clientes -->                     <div style='font-size:18px; font-weight:700; color:#111827;'>                         ðŸ“¦ Ãšltimos Pedidos de Clientes                     </div>                 </div>                 <!-- AJUSTE: Texto dinÃ¢mico com COUNTROWS -->                 <div style='font-size:13px; color:#6B7280; margin-left:14px;'>                     Monitoramento dos Ãºltimos " & COUNTROWS(TopPedidos) & " pedidos realizados por clientes                 </div>             </div>                          <div style='display:flex; align-items:center; gap:8px;'>                 <div style='background:#F3F4F6; padding:6px 12px; border-radius:8px; font-size:12px; color:#4B5563; font-weight:500;'>                     <span style='color:#3B82F6; font-weight:600;'>" & COUNTROWS(TopPedidos) & "</span> registros                 </div>             </div>         </div>          <!-- Tabela -->         <div style='overflow-x:auto;'>             <table style='width:100%; border-collapse:collapse; font-size:14px; min-width:800px;'>                 <thead>                     <tr style='background:#F9FAFB; border-radius:8px;'>                         <th style='padding:14px 8px; text-align:left; font-size:11px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB;'>IDENTIFICAÃ‡ÃƒO</th>                         <th style='padding:14px 8px; text-align:left; font-size:11px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB;'>INFORMAÃ‡Ã•ES</th>                         <th style='padding:14px 8px; text-align:left; font-size:11px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB;'>CATEGORIA</th>                         <th style='padding:14px 8px; text-align:left; font-size:11px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB;'>VALOR TOTAL</th>                         <th style='padding:14px 8px; text-align:left; font-size:11px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB;'>SITUAÃ‡ÃƒO</th>                         <th style='padding:14px 8px; text-align:left; font-size:11px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB;'>AÃ‡Ã•ES</th>                     </tr>                 </thead>                                  <tbody>                     " & TabelaLinhas & "                 </tbody>             </table>         </div>          <!-- RodapÃ© -->         <div style='display:flex; justify-content:space-between; align-items:center; margin-top:20px; padding-top:16px; border-top:1px solid #E5E7EB; font-size:12px; color:#6B7280;'>             <div>                 <!-- AJUSTE: Contagem dinÃ¢mica no rodapÃ© -->                 <span style='color:#3B82F6; font-weight:600;'>" & COUNTROWS(TopPedidos) & "</span> pedidos exibidos â€¢                  <span style='color:#10B981;'>âœ“ Entregues</span> â€¢                  <span style='color:#3B82F6;'>â†’ Enviados</span> â€¢                  <span style='color:#F59E0B;'>âŒ› Pendentes</span>             </div>             <div style='display:flex; gap:12px;'>                 <div style='padding:4px 12px; background:#F3F4F6; border-radius:6px;'>                     Atualizado: " & FORMAT(NOW(), "dd/mm/yyyy HH:mm") & "                 </div>             </div>         </div>     </div>"| |O principal objetivo desta medida é fornecer um resumo dos últimos pedidos dos clientes, mostrando o ID do Pedido, Categoria do Produto, valor e status do pedido|Texto|HTML|
|Medidas|HTML Ranking Categorias | VAR TotalReceita = [Receita total]  /* 1. Base com Receita e CONTAGEM DE PEDIDOS por Categoria */ VAR BaseCategoria =     ADDCOLUMNS(         SUMMARIZE(             'olist_produtos_dataset',             'olist_produtos_dataset'[Categoria]         ),         "ReceitaCategoria", CALCULATE(SUM('olist_produtos_pedidos_dataset'[Valor_total])),         "ContagemPedidos", CALCULATE(COUNTROWS('olist_produtos_pedidos_dataset'))     )  /* 2. Filtra categorias vÃ¡lidas */ VAR BaseFiltrada =     FILTER(         BaseCategoria,         NOT ISBLANK([ReceitaCategoria]) && [ReceitaCategoria] > 0     )  /* 3. Ranking por Receita (maior receita = 1) */ VAR BaseRankeada =     ADDCOLUMNS(         BaseFiltrada,         "Rank", RANKX(BaseFiltrada, [ReceitaCategoria], , DESC)     )  /* 4. Aplica Top N (limitado a Top 5 para manter o estilo compacto) */ VAR TabelaFinal =      TOPN(5, BaseRankeada, [ReceitaCategoria], DESC)  /* 5. GeraÃ§Ã£o das linhas HTML */ VAR Linhas =     CONCATENATEX(         TabelaFinal,          /* VariÃ¡veis de Contexto de Linha */         VAR Categoria = [Categoria]          VAR ReceitaUF = [ReceitaCategoria]         VAR ContagemUF = [ContagemPedidos]          VAR RankUF = [Rank]          VAR ReceitaFmt = FORMAT(ReceitaUF, "R$ #,##0")          VAR ContagemFmt = FORMAT(ContagemUF, "#,##0")                   /* ------------------------------------------------ */         /* CORES E ÃCONES PADRONIZADOS (Ouro, Prata, Bronze) */         /* ------------------------------------------------ */         VAR CorRank =             SWITCH(                 TRUE(),                 RankUF = 1, "#FBBF24", // Ouro                 RankUF = 2, "#D1D5DB", // Prata                 RankUF = 3, "#92400E", // Bronze                 "#2563EB" // Azul padrÃ£o para os demais (Top 4, 5)             )          VAR IconeRank =             SWITCH(                 TRUE(),                 RankUF = 1, "ðŸ¥‡",                 RankUF = 2, "ðŸ¥ˆ",                 RankUF = 3, "ðŸ¥‰",                 "" // NÃ£o exibe Ã­cone para os demais             )                      VAR CorContagem = // Cor para o texto secundÃ¡rio (pedidos)             SWITCH(                 TRUE(),                 RankUF = 1, "#B45309", // Tom de Ouro Escuro                 RankUF = 2, "#6B7280", // Cinza Escuro                 RankUF = 3, "#374151", // Marrom Escuro                 "#6B7280"             )          RETURN         "         <div style='             display:flex;              justify-content:space-between;              align-items:center;              padding:10px 0; /* REDUÃ‡ÃƒO: de 12px para 10px (aprox. 16.7%) */             border-bottom:1px solid #F3F4F6;             font-family: Segoe UI, sans-serif;             border-left: 4px solid " & CorRank & ";              padding-left: 8px;          '>             <div style='display:flex; align-items:center; gap:12px;'>                 <div style='                     width:36px;                      height:36px;                      background:" & CorRank & ";                     border-radius:100%;                      color:white;                      font-weight:700;                      font-size:15px;                      display:flex;                      justify-content:center;                      align-items:center;                 '>                     " & RankUF & "                 </div>                 <div>                     <div style='font-size:16px; font-weight:700; color:#1F2937;'>" & Categoria & " " & IconeRank & "</div>                                          <div style='font-size:12px; color:" & CorContagem & ";'>" & ContagemFmt & " pedidos</div>                 </div>             </div>              <div style='font-size:16px; font-weight:700; color:#1F2937;'>                 " & ReceitaFmt & "             </div>         </div>         ",         "",         [ReceitaCategoria], DESC     )  RETURN " <div style='     padding:16px;      background:white;      border-radius:12px;      box-shadow: 0 4px 6px rgba(0,0,0,0.05);      font-family: Segoe UI, sans-serif; '>     <div style='font-size:18px; font-weight:700; color:#1F2937; margin-bottom:10px;'>Top Categorias</div>     <div style='overflow-y:auto; max-height:400px;'>         " & Linhas & "     </div> </div> "| |O principal objetivo dessa medida é retornar as 5  categorias de produtos que possuem maior faturamento e apresentar em formato de ranking, com ícones unichar e cores personalizadas.|Texto|HTML|
|Medidas|HTML Ranking Estados - Compacto TopN2| VAR TotalReceita = [Receita total]  /* 1. Top N selecionado via segmentaÃ§Ã£o (Slicer) */ VAR TopNSelecionado = SELECTEDVALUE(TabelaTopN[N], 9999)  -- 9999 = Todos  /* 2. Base com colunas explÃ­citas (Receita por Estado) */ VAR Base =     ADDCOLUMNS(         SUMMARIZE(             'olist_clientes_dataset',             'olist_clientes_dataset'[Estado]         ),         "ReceitaEstado", CALCULATE([Receita total]),         "Perc", DIVIDE(CALCULATE([Receita total]), TotalReceita, 0)     )  /* 3. Filtra valores vÃ¡lidos */ VAR BaseFiltrada =     FILTER(Base, NOT ISBLANK([ReceitaEstado]) && [ReceitaEstado] > 0)  /* 4. Ranking (feito sobre a BaseFiltrada completa) */ VAR BaseRankeada =     ADDCOLUMNS(         BaseFiltrada,         "Rank", RANKX(BaseFiltrada, [ReceitaEstado], , DESC)     )  /* 5. Aplica o filtro Top N sobre o ranking calculado */ VAR BaseTopN =     FILTER(         BaseRankeada,         [Rank] <= TopNSelecionado     )  /* 6. OrdenaÃ§Ã£o final */ VAR TabelaFinal =     ADDCOLUMNS(         BaseTopN,         "Sort", [ReceitaEstado]     )  /* 7. GeraÃ§Ã£o das linhas HTML */ VAR Linhas =     CONCATENATEX(         TabelaFinal,          /* VariÃ¡veis de Contexto de Linha */         VAR UF = 'olist_clientes_dataset'[Estado] /* Garantia da referÃªncia escalar */         VAR ReceitaUF = [ReceitaEstado]         VAR PercUF = [Perc]         VAR RankUF = [Rank]          VAR ReceitaFmt = FORMAT(ReceitaUF, "R$ #,##0")         VAR PercFmt = FORMAT(PercUF, "0.0%")         VAR Largura = FORMAT(PercUF * 100, "0")          /* Cores por ranking */         VAR CorRank =             SWITCH(                 TRUE(),                 RankUF = 1, "#FBBF24",                 RankUF = 2, "#D1D5DB",                 RankUF = 3, "#92400E",                 RankUF <= 5, "#2563EB",                 RankUF <= 10, "#7C3AED",                 "#64748B"             )          VAR CorBarra =             SWITCH(                 TRUE(),                 RankUF = 1, "linear-gradient(90deg,#FBBF24,#F59E0B)",                 RankUF = 2, "linear-gradient(90deg,#D1D5DB,#9CA3AF)",                 RankUF = 3, "linear-gradient(90deg,#92400E,#78350F)",                 RankUF <= 5, "linear-gradient(90deg,#2563EB,#1D4ED8)",                 RankUF <= 10, "linear-gradient(90deg,#7C3AED,#6D28D9)",                 "linear-gradient(90deg,#64748B,#475569)"             )          VAR IconeRank =             SWITCH(                 TRUE(),                 RankUF = 1, "ðŸ¥‡",                 RankUF = 2, "ðŸ¥ˆ",                 RankUF = 3, "ðŸ¥‰",                 RankUF <= 10, "â­",                 "ðŸ“"             )          /* Cor do texto do % */         VAR CorPerc =             SWITCH(                 TRUE(),                 RankUF = 1, "#B45309",                    RankUF = 2, "#6B7280",                    "#374151"             )          RETURN         "         <div style='padding:12px; margin-bottom:8px; background:white; border-radius:12px;                     border-left:5px solid " & CorRank & "; box-shadow:0 2px 5px rgba(0,0,0,0.08);                     -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;'>              <div style='display:flex; justify-content:space-between; align-items:center;'>                  <div style='display:flex; gap:12px; align-items:center;'>                     <div style='width:36px; height:36px; background:" & CorRank & ";                                 border-radius:8px; color:white; font-weight:700; font-size:15px;                                 display:flex; align-items:center; justify-content:center;'>                         " & RankUF & "                     </div>                      <div style='font-size:15px; font-weight:700; color:#1F2937;'>" & UF & " " & IconeRank & "</div>                 </div>                  <div style='text-align:right; font-size:15px; font-weight:700; color:#1F2937;'>                     " & ReceitaFmt & " (<span style='color:" & CorPerc & ";'>" & PercFmt & "</span>)                 </div>              </div>              <div style='height:8px; background:#F1F5F9; border-radius:4px; overflow:hidden; margin-top:10px;'>                 <div style='height:100%; width:" & Largura & "%; background:" & CorBarra & ";'></div>             </div>          </div>         ",         "",         [Sort], DESC     )  RETURN " <div style='padding:8px; font-family:Segoe UI, sans-serif; -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;'>      <div style='max-height:400px; overflow-y:auto;'>         " & Linhas & "     </div>  </div> " | |Essa é uma medida de visualização (HTML) que calcula o ranking de Receita Total por Estado ([Estado]) e gera uma lista estilizada.  Seu objetivo é exibir, em formato de lista interativa, os estados que mais contribuíram para a receita.|Texto|HTML|
|Medidas|HTML Top 10 Clientes por Faturamento| // 1. A Tabela BaseClientes referencia a Tabela Calculada no modelo (Eficiente). VAR BaseClientes = 'Clientes Top N Base Final'  // 2. Filtra para obter o Top 10 VAR TopClientes =     TOPN(         10,         BaseClientes,         [ValorTotal], DESC      )  // 3. Adiciona a PosiÃ§Ã£o (Rank) ao Top 10 VAR TopClientesComPosicao =     ADDCOLUMNS(         TopClientes,         "@Posicao", RANKX(TopClientes, [ValorTotal], , DESC, DENSE)     )  // 4. Concatena as Linhas HTML VAR TabelaLinhas =     CONCATENATEX(         TopClientesComPosicao,                  // DefiniÃ§Ã£o das variÃ¡veis de formataÃ§Ã£o DENTRO do CONCATENATEX.         VAR ClienteID = LEFT([Cliente_ID], 8)         VAR Cidade = [Cidade]         VAR Estado = [Estado]         VAR CEP = [cep_cliente_inicial]         VAR Valor = FORMAT([ValorTotal], "R$ #,##0")          VAR Pedidos = [QtdPedidos]         VAR Posicao = [@Posicao]                  // **BUSCA O SEGMENTO RFV** (Assumindo que 'Tabela RFV Clientes' estÃ¡ no modelo)         VAR SegmentoCompleto =         LOOKUPVALUE(             'Tabela RFV Clientes'[Segmento RFV],             'Tabela RFV Clientes'[Cliente_ID], [Cliente_ID]         )                  // O Segmento remove o prefixo alfabÃ©tico se existir (Ex: A. CampeÃµes -> CampeÃµes)         VAR Segmento =              IF(                 LEFT(SegmentoCompleto, 3) IN {"A. ", "B. ", "C. ", "D. ", "E. ", "F. ", "G. ", "H. ", "I. ", "J. ", "K. "},                 RIGHT(SegmentoCompleto, LEN(SegmentoCompleto) - 3),                 SegmentoCompleto             )          // ------------------ DEFINIÃ‡ÃƒO DA COR HEXADECIMAL DO SEGMENTO ------------------         VAR CorSegmento =             SWITCH(                 TRUE(),                 SegmentoCompleto IN {"A. CampeÃµes", "CampeÃµes"}, "#10B981",                 SegmentoCompleto IN {"B. Clientes Leais", "Clientes Leais"}, "#34D399",                 SegmentoCompleto IN {"C. Potenciais", "Potenciais"}, "#6EE7B7",                 SegmentoCompleto IN {"D. Precisam de AtenÃ§Ã£o", "Precisam de AtenÃ§Ã£o"}, "#FBBF24",                 SegmentoCompleto IN {"E. Quase em Risco", "Quase em Risco"}, "#FCD34D",                 SegmentoCompleto IN {"F. Novos Clientes", "Novos Clientes"}, "#3B82F6",                 SegmentoCompleto IN {"G. Clientes em Risco", "Clientes em Risco"}, "#F87171",                 SegmentoCompleto IN {"H. NÃ£o pode Perder", "NÃ£o pode Perder"}, "#EF4444",                 SegmentoCompleto IN {"I. Hibernando", "Hibernando"}, "#9CA3AF",                 SegmentoCompleto IN {"J. Perdidos", "Perdidos"}, "#4B5563",                 "#D1D5DB" // Default (K. Clientes Diversos/Desconhecidos)             )         // ---------------------------------------------------------------------------------          VAR CorPosicao =             SWITCH(                 Posicao,                 1, "#FBBF24", // Ouro                 2, "#9CA3AF", // Prata                 3, "#B45309", // Bronze                 "#6B7280"     // Cinza             )                  VAR IconePosicao =             SWITCH(                 Posicao,                 1, "ðŸ¥‡",                 2, "ðŸ¥ˆ",                 3, "ðŸ¥‰",                 FORMAT(Posicao, "0")             )                  // Retorna a linha HTML          RETURN             "<tr style='border-bottom:1px solid #f0f0f0; transition: background-color 0.2s;'>                 <td style='padding:16px 8px; text-align:center; font-weight:700; font-size:18px; color:" & CorPosicao & ";'>                     " & IconePosicao & "                 </td>                 <td style='padding:14px 8px; font-weight:600; color:#1F2937; font-size:16px;'>                     " & ClienteID & "                 </td>                 <td style='padding:14px 8px; font-weight:600; font-size:16px; text-align:center;'>                     <div style='background:" & CorSegmento & "; color:white; padding:5px 11px; border-radius:6px; font-weight:700; font-size:15px; display:inline-block; box-shadow:0 1px 3px rgba(0,0,0,0.1);'>                         " & Segmento & "                     </div>                 </td>                 <td style='padding:14px 4px; color:#374151; font-size:16px;'>                      "                     // *** ALTERADO AQUI: ReduÃ§Ã£o do padding lateral para 4px para reduzir o espaÃ§o ***                     & "<div>" & Estado & "</div>                     <div style='font-size:14px; color:#9CA3AF;'>CEP: " & CEP & "</div>                 </td>                 <td style='padding:14px 8px; text-align:center;'>                     <div style='background:#DBEAFE; color:#1D4ED8; padding:8px 14px; border-radius:8px; font-weight:700; font-size:18px; display:inline-block;'>                         " & Pedidos & "                     </div>                 </td>                 <td style='padding:14px 8px; font-weight:700; color:#111827; font-size:18px; text-align:right;'>                     " & Valor & "                 </td>             </tr>",         "",          [ValorTotal], DESC      )  // 5. CÃ¡lculos para o RodapÃ© (Mantidos) VAR ValorTotalTop10 = SUMX(TopClientesComPosicao, [ValorTotal]) VAR ValorOuro = MAXX(FILTER(TopClientesComPosicao, [@Posicao] = 1), [ValorTotal]) VAR ValorPrata = MAXX(FILTER(TopClientesComPosicao, [@Posicao] = 2), [ValorTotal]) VAR ValorBronze = MAXX(FILTER(TopClientesComPosicao, [@Posicao] = 3), [ValorTotal])  // 6. Retorna o HTML Final  RETURN     "<div style='font-family: -apple-system, BlinkMacSystemFont, ""Segoe UI"", Roboto, sans-serif;                  background:white; border-radius:16px; padding:20px 24px;                  box-shadow:0 4px 16px rgba(0,0,0,0.08); border:1px solid #E5E7EB;'>          <div style='display:flex; align-items:center; justify-content:space-between; margin-bottom:20px;'>             <div>                 <div style='display:flex; align-items:center; gap:10px; margin-bottom:4px;'>                     <div style='width:4px; height:22px; background:#10B981; border-radius:2px;'></div>                     <div style='font-size:20px; font-weight:700; color:#111827;'>                         ðŸ† Top 10 Clientes por Faturamento                     </div>                 </div>                 <div style='font-size:15px; color:#6B7280; margin-left:14px;'>                     Clientes com maior valor acumulado em compras                 </div>             </div>                          <div style='display:flex; align-items:center; gap:12px;'>                 <div style='background:#10B981; color:white; padding:10px 18px; border-radius:8px; font-size:16px; font-weight:600;'>                     Total: " & FORMAT(ValorTotalTop10, "R$ #,##0") & "                 </div>             </div>         </div>          <div style='overflow-x:auto;'>             <table style='width:100%; border-collapse:collapse; font-size:16px; min-width:660px;'>                 <thead>                     <tr style='background:#F9FAFB; border-radius:8px;'>                         <th style='padding:16px 8px; text-align:center; font-size:13px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB; width:50px;'>POSIÃ‡ÃƒO</th>                         <th style='padding:16px 8px; text-align:left; font-size:13px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB; width:100px;'>CLIENTE</th>                         <th style='padding:16px 8px; text-align:center; font-size:13px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB; width:100px;'>SEGMENTO</th>                         <th style='padding:16px 4px; text-align:left; font-size:13px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB; width:130px;'>LOCALIZAÃ‡ÃƒO</th>                         <th style='padding:16px 8px; text-align:center; font-size:13px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB; width:80px;'>QTD PEDIDOS</th>                         <th style='padding:16px 8px; text-align:right; font-size:13px; color:#6B7280; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; border-bottom:2px solid #E5E7EB; width:120px;'>VALOR TOTAL</th>                     </tr>                 </thead>                                  <tbody>                     " & TabelaLinhas & "                 </tbody>             </table>         </div>          <div style='display:flex; justify-content:space-between; align-items:center; margin-top:20px; padding-top:16px; border-top:1px solid #E5E7EB; font-size:14px; color:#6B7280;'>             <div>                 <span style='color:#10B981; font-weight:600;'>" & COUNTROWS(TopClientes) & "</span> clientes top â€¢                  <span style='color:#FBBF24;'>ðŸ¥‡ Ouro: R$ " & IF(ISBLANK(ValorOuro), "0", FORMAT(ValorOuro, "#,##0")) & "</span> â€¢                  <span style='color:#9CA3AF;'>ðŸ¥ˆ Prata: R$ " & IF(ISBLANK(ValorPrata), "0", FORMAT(ValorPrata, "#,##0")) & "</span> â€¢                  <span style='color:#B45309;'>ðŸ¥‰ Bronze: R$ " & IF(ISBLANK(ValorBronze), "0", FORMAT(ValorBronze, "#,##0")) & "</span>             </div>             <div style='display:flex; gap:12px;'>                 <div style='padding:6px 14px; background:#F3F4F6; border-radius:6px;'>                     Atualizado: " & FORMAT(NOW(), "dd/mm/yyyy HH:mm") & "                 </div>             </div>         </div>     </div>"| |Essa é uma medida de visualização (HTML) que calcula o ranking de clientes com maior faturamento (top 10). Retorna a posição, ID do cliente, localização (estado e CEP), pedidos e faturamento total|Texto|HTML|
|Medidas|Pedidos|DISTINCTCOUNT(olist_pagamentos_dataset[ID_Pedido])|0|Calcula o número de pedidos|Número Inteiro|Pedidos|
|Medidas|Pedidos Pgto| VAR pgto = SELECTEDVALUE('olist_pagamentos_dataset'[forma_pgto]) RETURN IF(pgto = "not_defined", BLANK(), [Pedidos]) |0|Calcula o número de pedidos que tiveram forma de pagamento que não fosse "indefinido"|Número Inteiro|Pedidos|
|Medidas|Categorias|DISTINCTCOUNT(olist_produtos_dataset[Categoria])|0|Faz uma contagem da quantidade distinta de categorias de produtos|Número Inteiro|Produtos|
|Medidas|Produtos|SUM(olist_produtos_pedidos_dataset[Qtd.])|#,0|Calcula a quantidade de produtos|Número Inteiro|Produtos|
|Medidas|Itens/Pedido|DIVIDE('Medidas ðŸ“Š'[Produtos],[Pedidos],0)| |Calcula o número médio de produtos por pedido|Decimal| |
|Medidas|Peso Total KG| SUMX(     'olist_produtos_dataset',     'olist_produtos_dataset'[Peso kg] )| |Calcula o peso total do produto em kgs.|Decimal|Produtos|
|Medidas|Receita gerada por quilograma (kg)|DIVIDE([Receita total], [Peso Total KG],0)|"R$"#,0.0;-"R$"#,0.0;"R$"#,0.0|Calcula a receita média por peso (kg), dividindo a receita total pelo peso|Decimal|Ticket Médio|
|Medidas|Ticket Médio da Faixa de Peso| CALCULATE(     [Ticket Médio],     ALLEXCEPT(         'olist_produtos_dataset',         'olist_produtos_dataset'[Faixa Peso Simplificada]     ) ) |"R$"#,0;-"R$"#,0;"R$"#,0|Calcula  o ticket médio da faixa de peso selecionada|Decimal|Ticket Médio|
|Medidas|Volume cm³| SUMX(     'olist_produtos_dataset',     'olist_produtos_dataset'[altura_cm] *     'olist_produtos_dataset'[largura_cm] *     'olist_produtos_dataset'[comprimento_cm] ) |0|Calcula o volume do produto em cm³|Número Inteiro|Produtos|
|Medidas|Volume m³| SUMX(     'olist_produtos_dataset',     'olist_produtos_dataset'[altura_cm] *     'olist_produtos_dataset'[largura_cm] *     'olist_produtos_dataset'[comprimento_cm] )/1000000| |Calcula o volume do produto em m³|Decimal|Produtos|
|Medidas|Volume MéDIO por produto (cm³)|[Volume cmÂ³]/[Produtos]  | |Calcula a média de volume por produto em cm³|Decimal|Produtos|
|Medidas|Volume MéDIO por produto (m³)|[Volume MÃ‰DIO cmÂ³]/1000000| |Calcula a média de volume por produto em m³|Decimal|Produtos|
|Medidas|HTML Top 10 Vendedores| // 1. DefiniÃ§Ã£o da Tabela Base (Todos os Vendedores) VAR BaseVendedores =      CALCULATETABLE(         ADDCOLUMNS(             ALL('olist_vendedores_dataset'[Vendedor_ID]),             "@Score", [Score Total de Performance]         ),         ALL('olist_vendedores_dataset')     )  // 2. Filtra para obter o Top 10 com base no Score VAR TopVendedores =     TOPN(         10,         BaseVendedores,         [@Score], DESC      )  // 3. Adiciona a PosiÃ§Ã£o (Rank) VAR TopVendedoresComPosicao =     ADDCOLUMNS(         TopVendedores,         "@Ranking", RANKX(TopVendedores, [@Score], , DESC, DENSE)     )  // 4. Gera as linhas HTML (com fontes maiores) VAR TabelaLinhas =     CONCATENATEX(         TopVendedoresComPosicao,                  VAR VendedorID = 'olist_vendedores_dataset'[Vendedor_ID]         VAR VendedorID_Curto = LEFT(VendedorID, 10)         VAR ScoreFinal = [@Score]         VAR Ranking = [@Ranking]         VAR ScoreFormatado = FORMAT(ScoreFinal, "0.0")          VAR CorPosicao =             SWITCH(                 Ranking,                 1, "#FBBF24", // Ouro                 2, "#9CA3AF", // Prata                 3, "#B45309", // Bronze                 "#6B7280"    // Cinza             )          VAR IconePosicao =             SWITCH(                 Ranking,                 1, "ðŸ¥‡",                 2, "ðŸ¥ˆ",                 3, "ðŸ¥‰",                 FORMAT(Ranking, "0")             )          RETURN             "<tr style='border-bottom:1px solid #f0f0f0; transition: background-color 0.2s; height: 45px;'>                 <td style='padding:8px 6px; text-align:center; font-weight:800; font-size:22px; color:" & CorPosicao & "; width: 60px;'>                     " & IconePosicao & "                 </td>                 <td style='padding:8px 12px; font-weight:600; color:#1F2937; font-size:18px;'>                     " & VendedorID_Curto & "                 </td>                 <td style='padding:8px 6px; font-weight:800; color:#111827; font-size:22px; text-align:right; width: 100px;'>                     " & ScoreFormatado & "                 </td>             </tr>",         "",         [@Score], DESC     )  // 5. Estrutura final HTML RETURN     "<div style='font-family: -apple-system, BlinkMacSystemFont, ""Segoe UI"", Roboto, sans-serif;                 background: linear-gradient(180deg, #FFFFFF 0%, #F9FAFB 100%);                 border-radius:12px; padding:20px;                 box-shadow:0 4px 12px rgba(0,0,0,0.08); border:1px solid #E5E7EB;                  height: 100%; width: 100%; overflow: hidden; position: relative;'>          <!-- CabeÃ§alho melhorado -->         <div style='display:flex; align-items:center; justify-content:space-between; margin-bottom:20px; padding-bottom:12px; border-bottom:1px solid #E5E7EB;'>             <div style='display:flex; align-items:center; gap:10px;'>                 <div style='background: linear-gradient(135deg, #8B5CF6 0%, #6366F1 100%);                              width:40px; height:40px; border-radius:10px; display:flex;                              align-items:center; justify-content:center; color:white; font-size:20px;'>                     ðŸ‘‘                 </div>                 <div>                     <div style='font-size:22px; font-weight:800; color:#111827; line-height:1.2;'>                         Top " & COUNTROWS(TopVendedores) & " Vendedores                     </div>                     <div style='font-size:16px; color:#6B7280; margin-top:4px;'>                         Score composto por mÃºltiplas mÃ©tricas de performance                     </div>                 </div>             </div>                          <!-- Badge de total -->             <div style='background:#F3F4F6; padding:8px 16px; border-radius:20px; font-size:16px;                          font-weight:700; color:#4B5563;'>                 Total: " & COUNTROWS(TopVendedores) & "             </div>         </div>          <!-- Ãrea da tabela -->         <div style='overflow-y:auto; height: calc(100% - 140px);'>             <table style='width:100%; border-collapse:collapse;'>                 <thead>                     <tr style='background:#F9FAFB; position:sticky; top:0; z-index:10;'>                         <th style='padding:16px 8px; text-align:center; font-size:18px; color:#4B5563;                                     font-weight:700; border-bottom:2px solid #E5E7EB; width:80px;'>                             POSIÃ‡ÃƒO                         </th>                         <th style='padding:16px 16px; text-align:left; font-size:18px; color:#4B5563;                                     font-weight:700; border-bottom:2px solid #E5E7EB;'>                             VENDEDOR                         </th>                         <th style='padding:16px 12px; text-align:right; font-size:18px; color:#4B5563;                                     font-weight:700; border-bottom:2px solid #E5E7EB; width:120px;'>                             SCORE                         </th>                     </tr>                 </thead>                                  <tbody>                     " & TabelaLinhas & "                 </tbody>             </table>         </div>                   <!-- RodapÃ© melhorado -->         <div style='position:absolute; bottom:20px; left:20px; right:20px;                      padding-top:16px; border-top:1px solid #E5E7EB;                      display:flex; justify-content:space-between; align-items:center;'>             <div style='font-size:14px; color:#9CA3AF; display:flex; align-items:center; gap:6px;'>                 <div style='width:10px; height:10px; border-radius:50%; background:#10B981;'></div>             </div>             <div style='font-size:14px; color:#9CA3AF;'>             </div>         </div>     </div>"      | |Retorna através de um visual html os top 10 vendedores ranqueados através de um score de performance. Esse score é calculado através do valor vendido, ticket médio vendido e números de pedidos. Quanto maior, melhor o score.|Texto|Vendedores|
|Medidas|Score Pedidos (0-1)| VAR PedidosDoSeller = [Pedidos ] VAR MaxPedidosGlobal =      MAXX(         ALL('olist_vendedores_dataset'[Vendedor_ID]),         [Pedidos]     ) RETURN     DIVIDE(PedidosDoSeller, MaxPedidosGlobal, 0)| |Essa medida calcula a proporção de pedidos de cada vendedor em relação ao vendedor com o maior número de pedidos. Primeiro, obtém o total de pedidos do vendedor atual (Pedidos Seller). Em seguida, identifica o maior total de pedidos entre todos os vendedores e divide um pelo outro, retornando um valor percentual que mostra quão representativo cada vendedor é em comparação ao top seller.|Decimal|Vendedores|
|Medidas|Score Ticket Médio (0-1)| VAR TicketDoSeller = [Ticket Médio] VAR MaxTicketGlobal =      MAXX(         ALL('olist_vendedores_dataset'[Vendedor_ID]),         [Ticket Médio]     ) RETURN     DIVIDE(TicketDoSeller, MaxTicketGlobal, 0)| |Essa medida calcula a proporção de ticket médio de cada vendedor em relação ao vendedor com o maior número de pedidos. Primeiro, obtém o total de ticket médio do vendedor atual (Pedidos Seller). Em seguida, identifica o maior valor de ticket médio entre todos os vendedores e divide um pelo outro, retornando um valor percentual que mostra quão representativo cada vendedor é em comparação ao top seller.|Decimal|Vendedores|
|Medidas|Score Total de Performance| VAR ScorePrimario =      [Score Vendas (0-1)]      + [Score Ticket Médio (0-1)]      + [Score Pedidos (0-1)]  RETURN     ScorePrimario * 5.9| |A medida soma três indicadores normalizados entre 0 e 1 — Score de Vendas, Score de Ticket Médio e Score de Pedidos (que representa o número de pedidos do vendedor, normalizado). Esse total forma um score primário combinado. Em seguida, o resultado é multiplicado por 5,9, ajustando a escala final da pontuação.|Decimal|Vendedores|
|Medidas|Score Vendas (0-1)| VAR VendasDoSeller = [Vendas] VAR MaxVendasGlobal =      MAXX(         ALL('olist_vendedores_dataset'[Vendedor_ID]),         [Vendas]     ) RETURN     DIVIDE(VendasDoSeller, MaxVendasGlobal, 0)| |Essa medida calcula a proporção de receita de vendas de cada vendedor em relação ao vendedor com o maior valor de receita. Primeiro, obtém a receita total do vendedor atual (Pedidos Seller). Em seguida, identifica o maior valor de receita entre todos os vendedores e divide um pelo outro, retornando um valor percentual que mostra quão representativo cada vendedor é em comparação ao top seller.|Decimal|Vendedores|
|Medidas|Vendas|SUM('olist_produtos_pedidos_dataset'[Valor_total])|0|Essa medida retorna o valor total vendido|Número Inteiro|Vendedores|
|Medidas|Vendedores|DISTINCTCOUNT(olist_vendedores_dataset[Vendedor_ID])|#,0|Essa medida retorna o número total de vendedores do dataset|Número Inteiro|Vendedores|
|Medidas|Clientes CampeÃµes| CALCULATE(     DISTINCTCOUNT('Tabela RFV Clientes'[Cliente_ID]),     FILTER(         'Tabela RFV Clientes',         'Tabela RFV Clientes'[Segmento RFV] = "CampeÃµes"     ) ) |0|A medida conta quantos clientes únicos estão classificados no segmento “Campeões” dentro da Tabela RFV Clientes.|Número Inteiro|Clientes\RFV|
|Medidas|Clientes em Risco| CALCULATE(     DISTINCTCOUNT('Tabela RFV Clientes'[Cliente_ID]),     'Tabela RFV Clientes'[Segmento RFV] = "Clientes em Risco" )|0|A medida conta quantos clientes únicos estão classificados no segmento “Em risco” dentro da Tabela RFV Clientes.|Número Inteiro|Clientes\RFV|
|Medidas|Clientes Hibernando| CALCULATE(     DISTINCTCOUNT('Tabela RFV Clientes'[Cliente_ID]),     'Tabela RFV Clientes'[Segmento RFV] = "Hibernando" )|0|A medida conta quantos clientes únicos estão classificados no segmento “Hibernando” dentro da Tabela RFV Clientes.|Número Inteiro|Clientes\RFV|
|Medidas|Clientes Leais| CALCULATE(     DISTINCTCOUNT('Tabela RFV Clientes'[Cliente_ID]),     'Tabela RFV Clientes'[Segmento RFV] = "Clientes Leais" )|0|A medida conta quantos clientes únicos estão classificados no segmento “Leais” dentro da Tabela RFV Clientes.|Número Inteiro|Clientes\RFV|
|Medidas|Clientes RFV|DISTINCTCOUNT('Tabela RFV Clientes'[Cliente_ID])|#,0|A medida retorna o total de clientes da matriz rfv|Número Inteiro|Clientes\RFV|
|Medidas|Medida_HTML_Top_Reclamacoes_Tags| VAR HTML_Header = "<div style='font-family: Arial, sans-serif; font-size: 16px; padding: 5px;'>"  VAR HTML_Corpo =     CONCATENATEX(         'Top_10_Reclamacoes',         VAR Qtde = 'Top_10_Reclamacoes'[Quantidade]         VAR Percentual_Original = 'Top_10_Reclamacoes'[Percentual]          -- 1. CORREÃ‡ÃƒO: Divide o percentual por 100 para obter o valor decimal correto.         VAR Percentual_Corrigido = Percentual_Original / 100          -- 2. Cria o rÃ³tulo concatenado: Ex: 4321 (15,32%)         VAR Rotulo_Qtd_Pct =             FORMAT(Qtde, "#,##0") & " (" & FORMAT(Percentual_Corrigido, "0.00%") & ")"          -- 3. Define o estilo de cor (usaremos vermelho para Borda/Fundo e o cinza escuro para o texto)         VAR Cor_Fundo_Borda =             "border: 1px solid #CC0000; background-color: #FFEEED;" -- Vermelho (similar ao Negativo)                  VAR Cor_Texto = "color: #555555;" -- Cinza Escuro (Quase Preto)          -- 4. Gera a tag HTML/CSS         RETURN             "<span style='display: inline-block; padding: 5px 10px; margin: 4px; border-radius: 20px; font-size: 16px; font-weight: 500; " & Cor_Fundo_Borda & Cor_Texto & "'>" &             'Top_10_Reclamacoes'[Tipo_Problema] & " " & Rotulo_Qtd_Pct &             "</span>",         "" -- Sem separador entre as tags     )  VAR HTML_Footer = "</div>"  RETURN     HTML_Header & HTML_Corpo & HTML_Footer| |Essa medida gera um bloco HTML formatado que apresenta os itens da tabela Top_10_Reclamações como etiquetas visuais (tags). Para cada tipo de problema, ela monta um rótulo contendo a quantidade e o percentual corrigido, aplica estilos de cor e borda (vermelho para destaque) e concatena tudo em um único código HTML. O resultado é usado em visuais do Power BI que suportam HTML, exibindo as reclamações de forma organizada, estilizada e fácil de ler.|Texto|Avaliações|
